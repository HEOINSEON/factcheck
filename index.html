<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¯¸ë””ì–´ ë¦¬í„°ëŸ¬ì‹œ: íŒ©íŠ¸ì²´í¬ 8ëŒ€ ì›ì¹™ ì±Œë¦°ì§€</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter & Noto Sans KR Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+KR:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        .fact-button {
            transition: all 0.2s;
            min-height: 4.5rem; 
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
        }
        .fact-button:hover:not(.disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .fact-button.disabled {
            cursor: default;
            opacity: 0.7;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 10px;
        }
        .principle-item {
            cursor: pointer;
            transition: all 0.15s;
        }
        .principle-item:hover {
            background-color: #f0f9ff;
            border-color: #38bdf8;
        }
        .principle-item.selected {
            background-color: #e0f2fe;
            border-color: #06b6d4;
            box-shadow: 0 4px 6px rgba(6, 182, 212, 0.2);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-2xl bg-white rounded-xl shadow-2xl p-6 md:p-8 transform transition-all duration-500">
        
        <!-- Header -->
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-extrabold text-teal-600 mb-2">
                íŒ©íŠ¸ì²´í¬ 8ëŒ€ ì›ì¹™ ì±Œë¦°ì§€
            </h1>
            <p class="text-gray-500 text-sm md:text-base">ì •ë³´ ê²€ì¦ì˜ í•µì‹¬ ê¸°ì¤€ì„ í•™ìŠµí•˜ê³  ì ìš©í•´ë³´ì„¸ìš”.</p>
        </header>

        <!-- Principles Introduction Screen (STEP 1: í•™ìŠµ) -->
        <div id="intro-screen">
            <h2 class="text-xl font-bold text-sky-700 mb-4 border-b pb-2">í•µì‹¬ ì›ì¹™ í•™ìŠµí•˜ê¸° (í´ë¦­í•˜ì—¬ ìƒì„¸ ì •ë³´ í™•ì¸)</h2>
            
            <div class="md:flex md:space-x-4">
                
                <!-- 8ëŒ€ ì›ì¹™ ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ -->
                <div id="principle-list" class="flex flex-col gap-2 md:w-1/3 md:space-y-2 mb-4 md:mb-0 max-h-96 overflow-y-auto custom-scrollbar p-1">
                    <!-- Buttons generated by JS -->
                </div>

                <!-- ìƒì„¸ ì„¤ëª… ë° ì˜ˆì‹œ í‘œì‹œ ì˜ì—­ -->
                <div id="principle-detail-display" class="md:w-2/3 p-4 bg-sky-50 border border-sky-200 rounded-lg shadow-inner">
                    <h3 id="detail-title" class="text-xl font-bold text-teal-600 mb-3 border-b border-teal-200 pb-1">ì›ì¹™ì„ ì„ íƒí•˜ì—¬ í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”.</h3>
                    
                    <div class="space-y-4">
                        <p class="text-md font-semibold text-gray-700">ìƒì„¸ ì„¤ëª…</p>
                        <p id="detail-explanation" class="text-gray-700 text-sm leading-relaxed">ì™¼ìª½ì—ì„œ ì›ì¹™ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ë©´ í•´ë‹¹ ì›ì¹™ì˜ ì •ì˜ì™€ ì‹¤ì œ ì ìš© ì˜ˆì‹œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        
                        <p class="text-md font-semibold text-gray-700 border-t pt-3">ì ìš© ì˜ˆì‹œ</p>
                        <p id="detail-example" class="text-gray-600 text-sm italic leading-relaxed">ì˜ˆì‹œë¥¼ í†µí•´ í•´ë‹¹ ì›ì¹™ì´ ì–´ë–¤ ìƒí™©ì— ê°€ì¥ ë¨¼ì € ì ìš©ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
            
            <button id="start-challenge-button" class="mt-6 w-full py-3 font-semibold rounded-xl bg-teal-500 text-white hover:bg-teal-600 shadow-xl shadow-teal-300/50 transition duration-200" onclick="showUserInfoScreen()">
                âœ… ì±Œë¦°ì§€ ì‹œì‘í•˜ê¸°
            </button>
        </div>

        <!-- User Info Screen (STEP 2: ì •ë³´ ì…ë ¥) -->
        <div id="user-info-screen" class="hidden">
            <h2 class="text-2xl font-bold text-sky-700 mb-6 text-center">ë„ì „ì ì •ë³´ ì…ë ¥</h2>
            <div class="space-y-4">
                <p id="info-error-message" class="text-sm text-red-500 font-medium hidden"></p>
                
                <!-- í•™ë²ˆ ì…ë ¥ -->
                <div>
                    <label for="student-id" class="block text-sm font-medium text-gray-700 mb-1">í•™ë²ˆ (ìˆ«ì 5ìë¦¬)</label>
                    <input type="text" id="student-id" placeholder="ì˜ˆ: 12345" maxlength="5" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-150">
                </div>
                
                <!-- ì´ë¦„ ì…ë ¥ -->
                <div>
                    <label for="student-name" class="block text-sm font-medium text-gray-700 mb-1">ì´ë¦„</label>
                    <input type="text" id="student-name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-150">
                </div>
            </div>

            <div class="mt-8 flex space-x-4">
                <button class="w-1/3 py-3 font-semibold rounded-xl bg-gray-300 text-gray-800 hover:bg-gray-400 transition duration-200" onclick="showIntroScreen()">
                    â† ì›ì¹™ í•™ìŠµìœ¼ë¡œ
                </button>
                <button class="w-2/3 py-3 font-semibold rounded-xl bg-teal-500 text-white hover:bg-teal-600 shadow-xl shadow-teal-300/50 transition duration-200" onclick="validateAndStartQuiz()">
                    í€´ì¦ˆ ì‹œì‘!
                </button>
            </div>
        </div>


        <!-- Scoreboard and Status (Only visible during quiz) -->
        <div id="scoreboard" class="flex items-center justify-between mb-6 p-3 bg-teal-50 rounded-lg shadow-inner border border-teal-200 hidden">
            <!-- Back Button / Status Group -->
            <div class="flex items-center space-x-3">
                <button onclick="returnToUserInfo()" class="text-sm font-medium text-gray-600 hover:text-gray-800 bg-teal-100 px-3 py-1 rounded-full transition duration-150">
                    â† ì •ë³´ ì…ë ¥ìœ¼ë¡œ
                </button>
                <p class="text-lg font-semibold text-teal-700">
                    <span id="current-index-display">1</span> / <span id="total-items-display"></span> í•­ëª©
                </p>
            </div>
            
            <!-- Score & User Info -->
            <div class="text-right">
                 <p class="text-xs text-gray-600"><span id="user-info-display"></span></p>
                <p class="text-xl font-bold text-green-600">
                    ì ìˆ˜: <span id="score-display">0</span>ì 
                </p>
            </div>
        </div>

        <!-- Main Quiz Card Section (STEP 3 - Hidden initially) -->
        <div id="quiz-card" class="hidden">
            
            <!-- Fact Check Item -->
            <div class="bg-sky-50 border-l-4 border-sky-500 p-5 rounded-lg shadow-md mb-6 h-40 flex flex-col justify-center">
                <p class="text-sm font-semibold text-sky-700 mb-2">ë¬¸ì œ ìƒí™© (ê°€ì •ëœ ì •ë³´):</p>
                <p id="statement-text" class="text-lg font-bold text-gray-800 leading-relaxed">
                    ë¡œë”© ì¤‘...
                </p>
            </div>

            <p class="text-md font-semibold text-gray-700 mb-4 text-center">
                ì´ ì •ë³´ë¥¼ ê²€ì¦í•  ë•Œ, ê°€ì¥ ë¨¼ì € ì ìš©í•´ì•¼ í•  í•µì‹¬ ì›ì¹™ì€ ë¬´ì—‡ì¼ê¹Œìš”?
            </p>

            <!-- Principle Buttons Container -->
            <div id="answer-buttons" class="grid grid-cols-2 gap-3">
                <!-- Buttons will be generated by JavaScript -->
            </div>

            <!-- Feedback Area (Hidden initially) -->
            <div id="feedback-area" class="mt-6 p-4 rounded-xl shadow-lg border hidden transition-all duration-300">
                <h3 id="feedback-title" class="text-xl font-bold mb-2"></h3>
                <p id="correct-answer-info" class="text-sm font-semibold text-gray-600 mb-3 hidden">
                    ì •ë‹µ ì›ì¹™: <span id="correct-principle-text" class="text-sky-600 font-bold"></span>
                </p>
                
                <!-- íŒíŠ¸ / ì„¤ëª… ì˜ì—­ -->
                <div class="max-h-36 overflow-y-auto custom-scrollbar">
                    <p id="hint-text" class="text-orange-600 font-semibold mb-2 hidden"></p>
                    <p id="explanation-text" class="text-gray-700"></p>
                </div>

                <!-- Combined Navigation Buttons -->
                <div class="mt-4 flex space-x-3">
                    <button id="prev-button" class="w-1/2 py-2 font-semibold rounded-lg bg-gray-300 text-gray-800 hover:bg-gray-400 transition duration-150 hidden" onclick="previousItem()">
                        â† ì´ì „ ë¬¸ì œë¡œ
                    </button>
                    <!-- [ìˆ˜ì •]: nextItem() í´ë¦­ í•¸ë“¤ëŸ¬ ì¶”ê°€ -->
                    <button id="next-button" class="w-full py-2 font-semibold rounded-lg bg-teal-500 text-white opacity-50 cursor-not-allowed transition duration-150" disabled onclick="nextItem()">
                        ë‹¤ìŒ ë¬¸ì œë¡œ (ì •ë‹µì„ ë§ì¶”ì„¸ìš”)
                    </button>
                </div>
            </div>
            
        </div>

        <!-- Completion Screen (STEP 4 - Hidden initially) -->
        <div id="completion-screen" class="text-center p-8 hidden">
            <h2 class="text-3xl font-bold text-teal-600 mb-4">í•™ìŠµ ì™„ë£Œ! ğŸ‰</h2>
             <p class="text-md text-gray-700 mb-2 font-semibold"><span id="final-user-info-display"></span>ë‹˜ì˜</p>
            <p class="text-xl text-gray-700 mb-6">ìµœì¢… ì ìˆ˜ëŠ”...</p>
            <p class="text-5xl font-extrabold text-teal-500 mb-8">
                <span id="final-score-display">0</span>ì 
            </p>
            <p class="text-gray-600 mb-6">íŒ©íŠ¸ì²´í¬ 8ëŒ€ ì›ì¹™ ì±Œë¦°ì§€ë¥¼ ëª¨ë‘ ì™„ë£Œí•˜ì…¨ìŠµë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!</p>
            <button class="py-3 px-6 text-lg font-bold rounded-xl bg-sky-500 text-white hover:bg-sky-600 shadow-xl shadow-sky-300/50 transition duration-200" onclick="showIntroScreen()">
                ğŸ”„ ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </button>
        </div>

    </div>

    <script type="text/javascript">
        // 8ëŒ€ íŒ©íŠ¸ì²´í¬ ì›ì¹™ ì •ì˜ (í•™ìŠµ í™”ë©´ ë° í€´ì¦ˆì— ì‚¬ìš©)
        const principles = {
            'Source': { 
                text: 'ğŸ” ì¶œì²˜ ì‹ ë¢°ë„', 
                detail: 'ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì£¼ì²´ê°€ ì „ë¬¸ê°€ì¸ì§€, ê³µì‹ ë ¥ ìˆëŠ” ê¸°ê´€ì¸ì§€, ê·¸ë¦¬ê³  ê·¸ë“¤ì´ ì •ë³´ë¥¼ ì™œ ì œê³µí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.',
                example: 'ê³µì‹ì ì¸ ì •ë¶€ ì •ì±… ë‰´ìŠ¤ë¥¼ ìµëª…ì˜ ë¸”ë¡œê±°ê°€ ì•„ë‹Œ ì •ë¶€ ë°œí‘œ ì±„ë„ì´ë‚˜ ê³µì‹ ë ¥ ìˆëŠ” ì–¸ë¡  ë³´ë„ë¥¼ í†µí•´ í™•ì¸í•˜ëŠ” ê²ƒ.',
                color: 'bg-sky-500', shadow: 'shadow-sky-300/50', hint: 'ëˆ„ê°€ ì´ ì •ë³´ë¥¼ ì œê³µí–ˆë‚˜ìš”? ë¯¿ì„ ë§Œí•œ ê³³ì¸ê°€ìš”?'
            },
            'Evidence': { 
                text: 'ğŸ“œ ì¦ê±° ìë£Œ í™•ì¸', 
                detail: 'ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” í†µê³„, ì‚¬ì§„, ë¬¸ì„œ ë“±ì˜ ì¦ê±°ê°€ ì¶©ë¶„í•˜ê³  ê°ê´€ì ì¸ì§€, ê·¸ë¦¬ê³  ì¦ê±° ìì²´ê°€ ì¡°ì‘ë˜ì§„ ì•Šì•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.',
                example: 'íŠ¹ì • í†µê³„ ìˆ˜ì¹˜ë¥¼ ì¸ìš©í–ˆë‹¤ë©´, í•´ë‹¹ í†µê³„ì˜ ì›ë³¸ ìë£Œ(ì˜ˆ: ì •ë¶€ ë³´ê³ ì„œ)ë¥¼ ì°¾ì•„ ìˆ˜ì¹˜ì™€ ì¡°ì‚¬ ë°©ë²•ì„ í™•ì¸í•˜ëŠ” ê²ƒ.',
                color: 'bg-indigo-500', shadow: 'shadow-indigo-300/50', hint: 'ì£¼ì¥ ë§ê³ , ì‹¤ì œë¡œ ë³´ì—¬ì£¼ëŠ” ê°ê´€ì ì¸ ìë£Œê°€ ì¶©ë¶„í•œê°€ìš”?'
            },
            'Date': { 
                text: 'â±ï¸ ë‚ ì§œ/ì‹œì  íŒŒì•…', 
                detail: 'ì •ë³´ê°€ ìµœì‹  ì •ë³´ì¸ì§€, ì˜¤ë˜ëœ ì •ë³´ê°€ ìƒˆë¡œìš´ ì‚¬ê±´ì¸ ê²ƒì²˜ëŸ¼ ì¬ì‚¬ìš©ëœ ê²ƒì€ ì•„ë‹Œì§€ í™•ì¸í•˜ì—¬ ë§¥ë½ì˜ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.',
                example: 'í˜„ì¬ ìœ í–‰í•˜ëŠ” ì§ˆë³‘ì— ëŒ€í•œ ê¸°ì‚¬ì— ì²¨ë¶€ëœ ì‚¬ì§„ì´ 10ë…„ ì „ ìë£Œë¼ë©´, í•´ë‹¹ ì‚¬ì§„ì„ ì´ìš©í•´ í˜„ ìƒí™©ì„ íŒë‹¨í•˜ì§€ ì•ŠëŠ” ê²ƒ.',
                color: 'bg-orange-500', shadow: 'shadow-orange-300/50', hint: 'ì´ ì •ë³´ê°€ ì§€ê¸ˆ, ì˜¤ëŠ˜ ë°œìƒí•œ ì¼ì— ëŒ€í•œ ì´ì•¼ê¸°ì¸ê°€ìš”?'
            },
            'Context': { 
                text: 'ğŸ–¼ï¸ ì „ì²´ ë§¥ë½ ì´í•´', 
                detail: 'ë¶€ë¶„ì ì¸ ì¸ìš©ì´ë‚˜ ì‚¬ì§„ë§Œìœ¼ë¡œ íŒë‹¨í•˜ì§€ ì•Šê³ , ì •ë³´ê°€ ì›ë˜ ì†í–ˆë˜ ì „ì²´ ì´ì•¼ê¸°ë‚˜ ìƒí™©ì„ íŒŒì•…í•˜ì—¬ ì™œê³¡ì„ í”¼í•©ë‹ˆë‹¤.',
                example: 'ì •ì¹˜ì¸ì´ ë†ë‹´ìœ¼ë¡œ í–ˆë˜ ë°œì–¸ì„ ì‹¬ê°í•œ ì •ì±… ë°œì–¸ìœ¼ë¡œ í¸ì§‘í•´ ë³´ë„í–ˆë‹¤ë©´, ì „ì²´ ì—°ì„¤ ì˜ìƒì„ í™•ì¸í•˜ì—¬ ì›ë˜ ì˜ë„ë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒ.',
                color: 'bg-pink-500', shadow: 'shadow-pink-300/50', hint: 'ì´ê²ƒì´ ì „ì²´ ì´ì•¼ê¸°ì˜ ì¼ë¶€ë§Œ ì˜ë¼ë‚¸ ê²ƒì€ ì•„ë‹Œê°€ìš”?'
            },
            'Bias': { 
                text: 'ğŸ—£ï¸ ì˜ë„/í¸í–¥ì„± ë¶„ì„', 
                detail: 'ì •ë³´ ì „ë‹¬ì(ë§¤ì²´, ê°œì¸)ê°€ íŠ¹ì • ì •ì¹˜ì , ê²½ì œì , ì‚¬íšŒì  ì˜ë„ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì€ì§€, ë˜ëŠ” ê°ì •ì ìœ¼ë¡œ í¸í–¥ë˜ì–´ ìˆì§€ ì•Šì€ì§€ ë¶„ì„í•©ë‹ˆë‹¤.',
                example: 'íŠ¹ì • ì œí’ˆì„ ì¹­ì°¬í•˜ëŠ” ê¸°ì‚¬ê°€ ì‚¬ì‹¤ì€ ê·¸ ê¸°ì—…ì˜ í›„ì›ìœ¼ë¡œ ì‘ì„±ëœ ê´‘ê³ ì¸ì§€ ì•„ë‹Œì§€ í™•ì¸í•˜ê³  ë¹„íŒì ìœ¼ë¡œ ë°›ì•„ë“¤ì´ëŠ” ê²ƒ.',
                color: 'bg-red-500', shadow: 'shadow-red-300/50', hint: 'ì´ ì •ë³´ë¥¼ ëˆ„ê°€, ì™œ ë§Œë“¤ì—ˆì„ê¹Œìš”? í˜¹ì‹œ ê°ì •ì ìœ¼ë¡œ ì¹˜ìš°ì¹˜ì§„ ì•Šì•˜ë‚˜ìš”?'
            },
            'Logic': { 
                text: 'ğŸ’¡ ë…¼ë¦¬ì  ì˜¤ë¥˜ ê²€í† ', 
                detail: 'ì£¼ì¥ê³¼ ê·¼ê±°ê°€ í•©ë¦¬ì ìœ¼ë¡œ ì—°ê²°ë˜ëŠ”ì§€, ë¹„ì•½ì´ë‚˜ ì˜ëª»ëœ ì¸ê³¼ ê´€ê³„(A ë•Œë¬¸ì— Bê°€ ì¼ì–´ë‚¬ë‹¤ëŠ” ì‹)ê°€ ì—†ëŠ”ì§€ ë…¼ë¦¬ êµ¬ì¡°ë¥¼ ì‚´í•ë‹ˆë‹¤.',
                example: '"ìš°ë¦¬ íšŒì‚¬ê°€ ì‘ë…„ì— ì„¸ê³„ ìµœê³ ì˜ ê¸°ìˆ ì„ ê°œë°œí–ˆìœ¼ë‹ˆ, ì˜¬í•´ ëª¨ë“  ì‹ ì œí’ˆì€ ë¬´ì¡°ê±´ ì„±ê³µí•  ê²ƒì´ë‹¤"ì™€ ê°™ì€ ë¹„ì•½ì  ì£¼ì¥ì„ ê²½ê³„í•˜ëŠ” ê²ƒ.',
                color: 'bg-yellow-500', shadow: 'shadow-yellow-300/50', hint: 'ì£¼ì¥ê³¼ ê·¼ê±° ì‚¬ì´ì— ë¹ ì§„ ë…¼ë¦¬ì ì¸ ì—°ê²°ê³ ë¦¬ê°€ ìˆë‚˜ìš”?'
            },
            'CrossCheck': { 
                text: 'ğŸ”— êµì°¨ í™•ì¸ (ë‹¤ë¥¸ ì¶œì²˜)', 
                detail: 'í•˜ë‚˜ì˜ ì •ë³´ë§Œ ë¯¿ì§€ ì•Šê³ , ê³µì‹ ë ¥ ìˆëŠ” ìµœì†Œ 2~3ê°œì˜ ë…ë¦½ì ì¸ ì¶œì²˜ì—ì„œ ê°™ì€ ì‚¬ì‹¤ì„ ë³´ë„í•˜ê³  ìˆëŠ”ì§€ ë¹„êµ í™•ì¸í•©ë‹ˆë‹¤.',
                example: 'ë‹¨ í•˜ë‚˜ì˜ ë§¤ì²´ë§Œ ë³´ë„í•œ ì¶©ê²©ì ì¸ ì‚¬ê±´ì— ëŒ€í•´, ë‹¤ë¥¸ ì£¼ìš” ì–¸ë¡ ì‚¬ë“¤ì´ë‚˜ ê³µì‹ ì±„ë„ì—ì„œë„ ê°™ì€ ë‚´ìš©ì„ ë³´ë„í•˜ëŠ”ì§€ ê²€ìƒ‰í•´ë³´ëŠ” ê²ƒ.',
                color: 'bg-teal-500', shadow: 'shadow-teal-300/50', hint: 'ë‹¤ë¥¸ ë¯¿ì„ ë§Œí•œ ê³³ì—ì„œë„ ê°™ì€ ì´ì•¼ê¸°ë¥¼ í•˜ê³  ìˆë‚˜ìš”?'
            },
            'Type': { 
                text: 'ğŸ§© ì •ë³´ ìœ í˜• ë¶„ë¥˜', 
                detail: 'ë³´ê³  ìˆëŠ” ì½˜í…ì¸ ê°€ ì‚¬ì‹¤(Fact)ì¸ì§€, ì˜ê²¬(Opinion)ì¸ì§€, ê´‘ê³ (Ad)ì¸ì§€, í’ì(Satire)ì¸ì§€ ë“± ì •ë³´ì˜ ë³¸ë˜ ìœ í˜•ì„ ì •í™•íˆ ë¶„ë¥˜í•©ë‹ˆë‹¤.',
                example: 'ì½”ë¯¸ë”” í”„ë¡œê·¸ë¨ì—ì„œ íŠ¹ì • ì‚¬íšŒ í˜„ìƒì„ í’ìí•œ ë‚´ìš©ì„ ì‹¤ì œ ë‰´ìŠ¤ ê¸°ì‚¬ë¡œ ì˜¤í•´í•˜ì§€ ì•Šê³  ì˜¤ë½ ì½˜í…ì¸ ë¡œ ë°›ì•„ë“¤ì´ëŠ” ê²ƒ.',
                color: 'bg-green-500', shadow: 'shadow-green-300/50', hint: 'ì´ê²ƒì´ ì‚¬ì‹¤(Fact)ì¸ê°€ìš”, ì•„ë‹ˆë©´ ì£¼ì¥ì´ë‚˜ ê´‘ê³ ì¸ê°€ìš”?'
            },
        };
        const principleKeys = Object.keys(principles);

        // íŒ©íŠ¸ì²´í¬ í•™ìŠµ ë¬¸í•­ ë°ì´í„° (í€´ì¦ˆì— ì‚¬ìš©)
        const factChecks = [
            {
                statement: "ì–´ë–¤ ìœ íŠœë¸Œ ì±„ë„ì—ì„œ 'ë‚´ë…„ì— ì •ë¶€ê°€ ë°œí‘œí•  ì˜ˆì •ì¸ ë¶€ë™ì‚° ì •ì±…ì˜ ë¹„ë°€ ìë£Œ'ë¼ë©° ì¶œì²˜ ë¶ˆëª…ì˜ ë¬¸ì„œë¥¼ ê³µê°œí–ˆìŠµë‹ˆë‹¤.",
                correct_principle: "Source",
                explanation: "ê³µì‹ì ì¸ ì •ë¶€ ì •ì±…ì´ë‚˜ ë¹„ë°€ ìë£ŒëŠ” ë°˜ë“œì‹œ ì •ë¶€ ë¶€ì²˜ë‚˜ ê³µì‹ ë ¥ ìˆëŠ” ì–¸ë¡ ì‚¬ì˜ ë³´ë„ë¥¼ í†µí•´ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ì¶œì²˜ê°€ ë¶ˆë¶„ëª…í•œ ì •ë³´ëŠ” ì‹ ë¢°í•  ìˆ˜ ì—†ìœ¼ë©°, ì¶œì²˜ê°€ ê³µì‹ ë ¥ì´ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤.",
                userAnswer: null, 
                isCorrectlyAnswered: false,
                attempts: 0 // ì‹œë„ íšŸìˆ˜ ì¶”ì ì„ ìœ„í•´ ì¶”ê°€
            },
            {
                statement: "í•œ SNS ê²Œì‹œë¬¼ì— 'í˜„ì¬ A ë„ì‹œì—ì„œ ëŒ€ê·œëª¨ í­ë™ì´ ë°œìƒí•˜ê³  ìˆë‹¤'ëŠ” ë¬¸êµ¬ì™€ í•¨ê»˜ 5ë…„ ì „ ë‹¤ë¥¸ êµ­ê°€ì—ì„œ ì´¬ì˜ëœ ì‹œìœ„ ì‚¬ì§„ì´ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.",
                correct_principle: "Date",
                explanation: "ì •ë³´ê°€ ìœ í¬ëœ ì‹œì ê³¼ ì‹¤ì œ ì‚¬ê±´ì´ ë°œìƒí•œ ì‹œì , ê·¸ë¦¬ê³  ì‚¬ì§„ì´ ì´¬ì˜ëœ ì‹œì ì„ ë¹„êµí•´ì•¼ í•©ë‹ˆë‹¤. ì˜¤ë˜ëœ ìë£Œë‚˜ ë‹¤ë¥¸ ë§¥ë½ì˜ ìë£Œë¥¼ í˜„ì¬ì˜ ì‚¬ê±´ì¸ ê²ƒì²˜ëŸ¼ ì˜¤ìš©í•˜ëŠ” ê²½ìš°ê°€ í”í•©ë‹ˆë‹¤. (ë‚ ì§œì™€ ì‹œì ì˜ ì •í™•ì„±)",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "í™˜ê²½ ê´€ë ¨ ê¸°ì‚¬ì—ì„œ 'ëª¨ë“  ê³¼í•™ìê°€ B ê¸°ì—…ì˜ ì‹ ê¸°ìˆ ì´ ì§€êµ¬ë¥¼ íŒŒê´´í•œë‹¤ê³  ë§í•˜ê³  ìˆë‹¤'ê³  ì£¼ì¥í–ˆìœ¼ë‚˜, ì‹¤ì œ ì¸ìš©í•œ ì „ë¬¸ê°€ëŠ” 3ëª…ë¿ì´ì—ˆìŠµë‹ˆë‹¤.",
                correct_principle: "Evidence",
                explanation: "'ëª¨ë“  ê³¼í•™ì'ì™€ ê°™ì€ ê³¼ì¥ëœ í‘œí˜„ê³¼ ë‹¬ë¦¬ ì œì‹œëœ ì¦ê±°(ì¸ìš©í•œ ì „ë¬¸ê°€ ìˆ˜)ê°€ ë¯¸ì•½í•˜ê±°ë‚˜ ë¶ˆë¶„ëª…í•©ë‹ˆë‹¤. ì£¼ì¥ì„ ë’·ë°›ì¹¨í•˜ëŠ” ì¦ê±°ê°€ ê°ê´€ì ì´ê³  ì¶©ë¶„í•œì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ í•„ìˆ˜ì…ë‹ˆë‹¤.",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "íŠ¹ì • ì •ì¹˜ì¸ì„ ë¹„íŒí•˜ëŠ” ê¸€ì—ì„œ, ê·¸ê°€ ê³¼ê±°ì— í–ˆë˜ ë‹¨ìˆœí•œ ë†ë‹´ì„ í˜„ì¬ì˜ ì‹¬ê°í•œ ì •ì±… ë¬¸ì œì™€ ì—°ê²° ì§€ì–´ ê·¸ì˜ ë¬´ëŠ¥í•¨ì„ ê°•ì¡°í•˜ëŠ” ë‚´ìš©.",
                correct_principle: "Context",
                explanation: "ì •ë³´ê°€ ì›ë˜ ì‚¬ìš©ëœ ìƒí™©(ë§¥ë½)ê³¼ í˜„ì¬ ì œì‹œë˜ëŠ” ë§¥ë½ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¨ìˆœ ë†ë‹´ì´ ì‹¬ê°í•œ ì •ì±… ë°œì–¸ìœ¼ë¡œ ë‘”ê°‘í•˜ëŠ” ê²ƒì²˜ëŸ¼, ë¶€ë¶„ì ì¸ ë°œì–¸ì´ë‚˜ ì‚¬ì§„ì„ ìê·¹ì ì¸ ë§¥ë½ìœ¼ë¡œ ë¼ì›Œ ë§ì¶”ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "ëŒ“ê¸€ì— 'ì´ ê¸°ì‚¬ëŠ” ì™„ì „íˆ ì„ ë™ì ì´ë©°, ê¸°ìëŠ” Cë‹¹ì˜ ìŠ¤íŒŒì´ì„ì´ í‹€ë¦¼ì—†ë‹¤'ì™€ ê°™ì´ ê°ì •ì„ ìê·¹í•˜ëŠ” ë‚´ìš©ì´ ê°€ë“í•œ ê²Œì‹œë¬¼.",
                correct_principle: "Bias",
                explanation: "ì •ë³´ ì „ë‹¬ìê°€ ì¤‘ë¦½ì ì¸ ì‹œê°ì„ ìœ ì§€í•˜ê³  ìˆëŠ”ì§€, ì•„ë‹ˆë©´ íŠ¹ì • ëª©ì ì„ ê°€ì§€ê³  ê°ì •ì ìœ¼ë¡œ í¸í–¥ëœ ì£¼ì¥ì„ í•˜ëŠ”ì§€ ë¶„ì„í•´ì•¼ í•©ë‹ˆë‹¤. ê·¹ë‹¨ì ì¸ ì–¸ì–´ë‚˜ ê°ì •ì ì¸ í‘œí˜„ì€ í¸í–¥ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì‹ í˜¸ì…ë‹ˆë‹¤.",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "D íšŒì‚¬ê°€ 'ìš°ë¦¬ëŠ” E ì œí’ˆì„ ì‹œì¥ì—ì„œ 1ìœ„ë¡œ ë§Œë“¤ì—ˆìœ¼ë¯€ë¡œ, F ì œí’ˆë„ ë¬´ì¡°ê±´ ì‹œì¥ì—ì„œ ì„±ê³µí•  ê²ƒì´ë‹¤'ë¼ê³  ê´‘ê³ í•˜ëŠ” ë‚´ìš©.",
                correct_principle: "Logic",
                explanation: "ë‘ ì£¼ì¥ì´ ë…¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°ë˜ëŠ”ì§€ ê²€í† í•´ì•¼ í•©ë‹ˆë‹¤. í•œ ë¶„ì•¼ì˜ ì„±ê³µì´ ë‹¤ë¥¸ ë¶„ì•¼ì˜ ì„±ê³µì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ” ê²ƒì²˜ëŸ¼, ë¹„ì•½ì ì´ê±°ë‚˜ ì˜ëª»ëœ ì¸ê³¼ ê´€ê³„ë¥¼ ì£¼ì¥í•˜ëŠ” ë…¼ë¦¬ì  ì˜¤ë¥˜ë¥¼ ì°¾ì•„ë‚´ì•¼ í•©ë‹ˆë‹¤. (ë…¼ë¦¬ì˜ ë¹„ì•½ í™•ì¸)",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "í•œ ë°©ì†¡ì‚¬ê°€ 'ìµœê·¼ ìœ í–‰í•˜ëŠ” C ì§ˆë³‘ ì¹˜ë£Œë²• ë°œê²¬' ê¸°ì‚¬ë¥¼ ë³´ë„í–ˆìœ¼ë‚˜, ë‹¤ë¥¸ ê³µì‹ ë ¥ ìˆëŠ” ì–¸ë¡ ì‚¬ë‚˜ ë³´ê±´ ë‹¹êµ­ì—ì„œëŠ” ê´€ë ¨ ë³´ë„ê°€ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.",
                correct_principle: "CrossCheck",
                explanation: "ë§¤ìš° ì¤‘ìš”í•˜ê±°ë‚˜ íŒŒê¸‰ë ¥ì´ í° ì •ë³´ì¼ìˆ˜ë¡ ì—¬ëŸ¬ ë…ë¦½ì ì¸ ì¶œì²˜ë¥¼ í†µí•´ ì‚¬ì‹¤ì„ êµì°¨ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. í•˜ë‚˜ì˜ ì¶œì²˜ë§Œ ë¯¿ê³  ì •ë³´ë¥¼ ìˆ˜ìš©í•˜ëŠ” ê²ƒì€ ìœ„í—˜í•©ë‹ˆë‹¤.",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
            {
                statement: "ë‰´ìŠ¤ ê¸°ì‚¬ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‚¬ì‹¤ì€ íŠ¹ì • ê¸°ì—…ì˜ ì œí’ˆì„ í™ë³´í•˜ê¸° ìœ„í•´ ì œì‘ëœ 'ê¸°ì‚¬ í˜•íƒœì˜ ê´‘ê³ (ë„¤ì´í‹°ë¸Œ ê´‘ê³ )'ì¸ ê²½ìš°.",
                correct_principle: "Type",
                explanation: "ìš°ë¦¬ê°€ ì ‘í•˜ëŠ” ì •ë³´ê°€ ë‰´ìŠ¤ì¸ì§€, ì˜ê²¬ ì¹¼ëŸ¼ì¸ì§€, ì•„ë‹ˆë©´ ê´‘ê³ ì¸ì§€ ê·¸ ë³¸ì§ˆì ì¸ ìœ í˜•ì„ íŒŒì•…í•´ì•¼ í•©ë‹ˆë‹¤. ì •ë³´ì˜ ìœ í˜•ì„ ì˜ëª» ë¶„ë¥˜í•˜ë©´ ë¹„íŒì  ì‚¬ê³ ë¥¼ ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì •ë³´ì˜ ë³¸ë˜ ëª©ì  í™•ì¸)",
                userAnswer: null,
                isCorrectlyAnswered: false,
                attempts: 0
            },
        ];

        let currentItemIndex = 0;
        let score = 0;
        let studentInfo = { id: '', name: '' };
        
        document.getElementById('total-items-display').textContent = factChecks.length;

        // --- ì ìˆ˜ ê³„ì‚° ë¡œì§ ì¶”ê°€ ---
        /**
         * ì‹œë„ íšŸìˆ˜ì— ë”°ë¼ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
         * @param {number} totalAttempts - ì •ë‹µì„ ë§ì¶”ëŠ” ë° ê±¸ë¦° ì´ ì‹œë„ íšŸìˆ˜ (1íšŒë¶€í„°)
         * @returns {number} ê³„ì‚°ëœ ì ìˆ˜
         */
        function getScoreForAttempts(totalAttempts) {
            if (totalAttempts === 1) return 30;
            if (totalAttempts === 2) return 20;
            if (totalAttempts === 3) return 10;
            if (totalAttempts === 4) return 5;
            return 0; // 5íšŒ ì´ìƒ ì‹œë„
        }
        // --- í™”ë©´ ì „í™˜ ë° ì´ˆê¸°í™” í•¨ìˆ˜ ---
        
        // ëª¨ë“  í™”ë©´ì„ ìˆ¨ê¸°ëŠ” ìœ í‹¸ë¦¬í‹°
        function hideAllScreens() {
            ['intro-screen', 'user-info-screen', 'scoreboard', 'quiz-card', 'completion-screen'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
        }

        function showScreen(id) {
            hideAllScreens();
            document.getElementById(id).classList.remove('hidden');
        }

        /**
         * ì´ˆê¸° í•™ìŠµ í™”ë©´ì„ í‘œì‹œí•˜ê³  8ëŒ€ ì›ì¹™ ì„¤ëª…ì„ ì±„ì›ë‹ˆë‹¤. (STEP 1)
         */
        function showIntroScreen() {
            showScreen('intro-screen');
            
            const listContainer = document.getElementById('principle-list');
            listContainer.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

            // 8ëŒ€ ì›ì¹™ ë²„íŠ¼ ìƒì„±
            principleKeys.forEach(key => {
                const p = principles[key];
                const button = document.createElement('button');
                
                button.className = 'principle-item w-full text-sm font-semibold py-2 px-3 border rounded-lg text-teal-700 bg-white hover:bg-sky-50 transition duration-150';
                button.setAttribute('data-key', key);
                button.setAttribute('onclick', `showPrincipleDetail('${key}')`);
                button.textContent = p.text;
                listContainer.appendChild(button);
            });
        }
        
        /**
         * ì„ íƒëœ ì›ì¹™ì˜ ìƒì„¸ ì •ë³´(ì„¤ëª… ë° ì˜ˆì‹œ)ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function showPrincipleDetail(key) {
            const p = principles[key];

            // 1. ìƒì„¸ ì˜ì—­ ì—…ë°ì´íŠ¸
            document.getElementById('detail-title').textContent = p.text;
            document.getElementById('detail-explanation').textContent = p.detail;
            document.getElementById('detail-example').textContent = p.example;

            // 2. ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸ ë³€ê²½
            const listContainer = document.getElementById('principle-list');
            listContainer.querySelectorAll('.principle-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.querySelector(`.principle-item[data-key="${key}"]`).classList.add('selected');
        }

        /**
         * ì‚¬ìš©ì ì •ë³´ ì…ë ¥ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤. (STEP 2)
         */
        function showUserInfoScreen() {
            showScreen('user-info-screen');
            document.getElementById('student-id').value = studentInfo.id;
            document.getElementById('student-name').value = studentInfo.name;
            document.getElementById('info-error-message').classList.add('hidden');
        }

        /**
         * ì‚¬ìš©ì ì •ë³´ë¥¼ ê²€ì¦í•˜ê³  í€´ì¦ˆë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
         */
        function validateAndStartQuiz() {
            const studentId = document.getElementById('student-id').value.trim();
            const studentName = document.getElementById('student-name').value.trim();
            const errorElement = document.getElementById('info-error-message');
            
            errorElement.classList.add('hidden');
            
            // í•™ë²ˆ ìœ íš¨ì„± ê²€ì‚¬ (5ìë¦¬ ìˆ«ì)
            if (!/^\d{5}$/.test(studentId)) {
                errorElement.textContent = "âš ï¸ í•™ë²ˆì€ ì •í™•íˆ 5ìë¦¬ì˜ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.";
                errorElement.classList.remove('hidden');
                return;
            }

            // ì´ë¦„ ìœ íš¨ì„± ê²€ì‚¬
            if (studentName.length < 2) {
                errorElement.textContent = "âš ï¸ ì´ë¦„ì„ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                errorElement.classList.remove('hidden');
                return;
            }
            
            // ì •ë³´ ì €ì¥
            studentInfo = { id: studentId, name: studentName };

            // í€´ì¦ˆ ì‹œì‘
            startQuiz();
        }

        /**
         * í€´ì¦ˆë¥¼ ì´ˆê¸°í™”í•˜ê³  í€´ì¦ˆ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function startQuiz() {
            currentItemIndex = 0;
            score = 0;

            // ë¬¸ì œ ìƒíƒœ ì´ˆê¸°í™”
            factChecks.forEach(item => {
                item.userAnswer = null;
                item.isCorrectlyAnswered = false;
                item.attempts = 0; // ì‹œë„ íšŸìˆ˜ ì´ˆê¸°í™”
            });

            showQuizCard();
        }

        /**
         * í€´ì¦ˆ ì¹´ë“œì™€ ì ìˆ˜íŒì„ í‘œì‹œí•©ë‹ˆë‹¤. (STEP 3)
         */
        function showQuizCard() {
            hideAllScreens();
            document.getElementById('scoreboard').classList.remove('hidden');
            document.getElementById('quiz-card').classList.remove('hidden');
            
            // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
            document.getElementById('user-info-display').textContent = `${studentInfo.id} / ${studentInfo.name}`;
            
            displayCurrentItem();
        }
        
        /**
         * í€´ì¦ˆ ì§„í–‰ ì¤‘ ì‚¬ìš©ì ì •ë³´ ì…ë ¥ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
         */
        function returnToUserInfo() {
            // í€´ì¦ˆ ì§„í–‰ ìƒí™©(ì ìˆ˜, ì§„í–‰ë„)ì€ ìœ ì§€í•œ ì±„ í™”ë©´ë§Œ ì „í™˜
            showUserInfoScreen();
        }

        // --- í€´ì¦ˆ ë¡œì§ ---
        
        /**
         * ë°°ì—´ì„ ì„ëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (Fisher-Yates)
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™í•©ë‹ˆë‹¤. (ì •ë‹µì„ ë§ì¶˜ í›„ì—ë§Œ í˜¸ì¶œ ê°€ëŠ¥)
         */
        function nextItem() {
            currentItemIndex++;
            displayCurrentItem();
        }

        /**
         * ì´ì „ ë¬¸ì œë¡œ ì´ë™í•©ë‹ˆë‹¤.
         */
        function previousItem() {
            if (currentItemIndex > 0) {
                currentItemIndex--;
                displayCurrentItem();
            }
        }

        /**
         * ì±Œë¦°ì§€ í•­ëª©ì„ í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
         */
        function displayCurrentItem() {
            if (currentItemIndex >= factChecks.length) {
                showCompletionScreen();
                return;
            }

            const item = factChecks[currentItemIndex];

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('statement-text').textContent = item.statement;
            document.getElementById('current-index-display').textContent = currentItemIndex + 1;
            document.getElementById('score-display').textContent = score;

            // 4ê°œì˜ ë³´ê¸° ë²„íŠ¼ ìƒì„± (ì˜µì…˜ì„ í•­ìƒ ì„¤ì •)
            generatePrincipleButtons(item.correct_principle);
            
            // í”¼ë“œë°±/íŒíŠ¸ ì˜ì—­ ì´ˆê¸°í™” ë° ìˆ¨ê¸°ê¸°
            document.getElementById('feedback-area').classList.add('hidden');
            document.getElementById('hint-text').classList.add('hidden');
            document.getElementById('correct-answer-info').classList.add('hidden');
            
            // ë²„íŠ¼ ì¬í™œì„±í™”
            document.querySelectorAll('#answer-buttons button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-offset-2', 'ring-red-400', 'ring-green-400', 'ring-sky-400', 'disabled');
                btn.classList.remove('opacity-50');
                btn.removeAttribute('disabled');
            });
            document.getElementById('answer-buttons').classList.remove('pointer-events-none');
            
            // ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ë¬¸ì œë¼ë©´, í”¼ë“œë°±ì„ ë°”ë¡œ í‘œì‹œí•˜ê³  ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”
            if (item.isCorrectlyAnswered) {
                // isReplay=trueë¡œ ì„¤ì •í•˜ì—¬ ì ìˆ˜ ì¤‘ë³µ ìƒìŠ¹ì„ ë°©ì§€í•˜ê³  í”¼ë“œë°±ë§Œ í‘œì‹œ
                // awardedPointsëŠ” 0ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ í”¼ë“œë°± í…ìŠ¤íŠ¸ë¥¼ ê°„ê²°í•˜ê²Œ ìœ ì§€
                submitAnswer(item.userAnswer, true); 
            } else {
                 // ì •ë‹µì„ ë§ì¶”ì§€ ëª»í•œ ë¬¸ì œë¼ë©´, ë²„íŠ¼ ì´ˆê¸°í™” ìƒíƒœë¡œ ë³µêµ¬
                updateNavigationButtons(false); 
            }
        }

        /**
         * ë‹¤ìŒ/ì´ì „ ë²„íŠ¼ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         * @param {boolean} isCorrect - í˜„ì¬ ë¬¸ì œê°€ ì •ë‹µ ìƒíƒœì¸ì§€ ì—¬ë¶€
         */
        function updateNavigationButtons(isCorrect) {
            const nextButton = document.getElementById('next-button');
            const prevButton = document.getElementById('prev-button');
            
            // ì´ì „ ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€
            if (currentItemIndex > 0) {
                prevButton.classList.remove('hidden');
                // ì •ë‹µì„ ë§ì¶˜ ê²½ìš°ì—ë§Œ ë‹¤ìŒ ë²„íŠ¼ê³¼ ì´ì „ ë²„íŠ¼ì´ ë„ˆë¹„ë¥¼ ê³µìœ í•¨
                prevButton.classList.toggle('w-1/2', isCorrect); 
            } else {
                prevButton.classList.add('hidden');
            }

            // ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ (ì •ë‹µì„ ë§ì¶˜ ê²½ìš°ì—ë§Œ í™œì„±í™”)
            if (isCorrect) {
                nextButton.disabled = false;
                nextButton.classList.remove('opacity-50', 'cursor-not-allowed');
                nextButton.classList.add('hover:bg-teal-600');
                
                // ì´ì „ ë²„íŠ¼ì´ ìˆ¨ê²¨ì ¸ ìˆìœ¼ë©´ ë‹¤ìŒ ë²„íŠ¼ì´ ì „ì²´ ë„ˆë¹„ë¥¼ ê°€ì§
                const isPrevHidden = prevButton.classList.contains('hidden');
                nextButton.classList.toggle('w-full', isPrevHidden);
                nextButton.classList.toggle('w-1/2', !isPrevHidden);

                nextButton.textContent = (currentItemIndex === factChecks.length - 1) ? "ìµœì¢… í•™ìŠµ ê²°ê³¼ í™•ì¸í•˜ê¸°" : "ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™";
            } else {
                nextButton.disabled = true;
                nextButton.classList.add('opacity-50', 'cursor-not-allowed');
                nextButton.classList.remove('hover:bg-teal-600', 'w-1/2');
                nextButton.classList.add('w-full');
                nextButton.textContent = "ë‹¤ìŒ ë¬¸ì œë¡œ (ì •ë‹µì„ ë§ì¶”ì„¸ìš”)";
            }
        }


        /**
         * 4ê°œì˜ ë³´ê¸° ë²„íŠ¼ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
         * @param {string} correctKey - ì •ë‹µ ì›ì¹™ í‚¤
         */
        function generatePrincipleButtons(correctKey) {
            const container = document.getElementById('answer-buttons');
            container.innerHTML = '';
            
            // ì˜¤ë‹µ í›„ë³´ 3ê°œ ë¬´ì‘ìœ„ ì„ íƒ í›„ ìˆœì„œ ì„ê¸°
            const incorrectKeys = principleKeys.filter(key => key !== correctKey);
            const shuffledIncorrectKeys = shuffleArray(incorrectKeys);
            const selectedKeys = [correctKey, ...shuffledIncorrectKeys.slice(0, 3)];
            const shuffledOptions = shuffleArray(selectedKeys);

            // ë²„íŠ¼ ìƒì„± ë° DOMì— ì¶”ê°€
            shuffledOptions.forEach(key => {
                const principle = principles[key];
                const button = document.createElement('button');
                
                button.className = `fact-button py-3 px-2 text-sm md:text-md font-bold rounded-xl ${principle.color} text-white hover:${principle.color.replace('-500', '-600')} shadow-lg ${principle.shadow} transition duration-200`;
                button.setAttribute('data-principle', key);
                button.setAttribute('onclick', `submitAnswer('${key}')`);
                button.textContent = principle.text;
                container.appendChild(button);
            });
        }

        /**
         * ì‚¬ìš©ìì˜ ë‹µë³€ì„ ì²˜ë¦¬í•˜ê³  í”¼ë“œë°±ì„ í‘œì‹œí•©ë‹ˆë‹¤.
         * @param {string} userAnswerPrinciple - ì‚¬ìš©ìê°€ ì„ íƒí•œ ì›ì¹™ í‚¤
         * @param {boolean} [isReplay=false] - ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ë¬¸ì œì¸ì§€ ì—¬ë¶€
         */
        function submitAnswer(userAnswerPrinciple, isReplay = false) {
            const item = factChecks[currentItemIndex];
            const isCorrect = (userAnswerPrinciple === item.correct_principle);
            let awardedPoints = 0;
            
            // 1. ìƒíƒœ ì €ì¥ (ì¬ì‹œë„ë¥¼ ìœ„í•´)
            item.userAnswer = userAnswerPrinciple;

            // ì˜¤ë‹µ ì²˜ë¦¬: ì‹œë„ íšŸìˆ˜ ì¦ê°€ (ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ë¬¸ì œëŠ” ì‹œë„ íšŸìˆ˜ ì¦ê°€ì‹œí‚¤ì§€ ì•ŠìŒ)
            if (!isCorrect && !item.isCorrectlyAnswered) {
                item.attempts++; // ì‹œë„ íšŸìˆ˜ ì¦ê°€
            }
            
            // 2. ì ìˆ˜ ì—…ë°ì´íŠ¸ ë° ìƒíƒœ í”Œë˜ê·¸ ì„¤ì • (ì •ë‹µì„ ì²˜ìŒ ë§ì·„ì„ ë•Œë§Œ ì ìˆ˜ ì¶”ê°€)
            if (isCorrect && !item.isCorrectlyAnswered) {
                const totalAttempts = item.attempts + 1; // 0íšŒ ì‹¤íŒ¨ + 1íšŒ ì„±ê³µ
                awardedPoints = getScoreForAttempts(totalAttempts); // ì ìˆ˜ ê³„ì‚°
                score += awardedPoints;
                item.isCorrectlyAnswered = true;
            } 
            
            // 3. í”¼ë“œë°± í‘œì‹œ
            showFeedback(userAnswerPrinciple, item.correct_principle, item, isCorrect, isReplay, awardedPoints);
        }

        /**
         * í”¼ë“œë°± ì˜ì—­ì„ í‘œì‹œí•˜ê³ , ë²„íŠ¼ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         * @param {string} userAnswer - ì‚¬ìš©ìê°€ ì„ íƒí•œ ì›ì¹™ í‚¤
         * @param {string} correctKey - ì •ë‹µ ì›ì¹™ í‚¤
         * @param {object} item - í˜„ì¬ í€´ì¦ˆ í•­ëª© ê°ì²´
         * @param {boolean} isCorrect - ì •ë‹µ ì—¬ë¶€
         * @param {boolean} isReplay - ì¬í™•ì¸ ì—¬ë¶€
         * @param {number} awardedPoints - íšë“í•œ ì ìˆ˜ (0ì ì¼ ìˆ˜ë„ ìˆìŒ)
         */
        function showFeedback(userAnswer, correctKey, item, isCorrect, isReplay, awardedPoints) {
            const feedbackArea = document.getElementById('feedback-area');
            const feedbackTitle = document.getElementById('feedback-title');
            const hintText = document.getElementById('hint-text');
            
            // í”¼ë“œë°± ì˜ì—­ ìƒ‰ìƒ/ì œëª© ì„¤ì •
            if (item.isCorrectlyAnswered) { // ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ìƒíƒœ
                const totalAttempts = item.attempts + 1;

                let titleText = `ğŸ‘ ì •ë‹µì…ë‹ˆë‹¤! (${totalAttempts}íšŒ ì‹œë„)`;
                if (awardedPoints > 0 && !isReplay) {
                    titleText += ` - ${awardedPoints}ì  íšë“!`;
                } else if (awardedPoints === 0 && !isReplay) {
                    titleText += ` - 0ì  íšë“ (5íšŒ ì´ìƒ ì‹œë„)`;
                } else if (isReplay) {
                     titleText = "ğŸ‘ ì´ë¯¸ ì •ë‹µì„ ë§ì¶˜ ë¬¸ì œì…ë‹ˆë‹¤.";
                }

                feedbackTitle.textContent = titleText;
                feedbackArea.classList.remove('border-red-400', 'bg-red-50');
                feedbackArea.classList.add('border-green-400', 'bg-green-50');
                feedbackTitle.classList.remove('text-red-600');
                feedbackTitle.classList.add('text-green-600');
                hintText.classList.add('hidden'); // ì •ë‹µì´ë¯€ë¡œ íŒíŠ¸ ìˆ¨ê¹€
                document.getElementById('correct-answer-info').classList.remove('hidden'); // ì •ë‹µ í‘œì‹œ
                document.getElementById('explanation-text').textContent = item.explanation;
            } else { // ì•„ì§ ì •ë‹µì„ ë§ì¶”ì§€ ëª»í•œ ìƒíƒœ (ì˜¤ë‹µ)
                feedbackTitle.textContent = `ğŸ¤” ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ìƒê°í•´ ë´…ì‹œë‹¤. (í˜„ì¬ ${item.attempts}íšŒ ì‹¤íŒ¨)`;
                feedbackArea.classList.remove('border-green-400', 'bg-green-50');
                feedbackArea.classList.add('border-red-400', 'bg-red-50');
                feedbackTitle.classList.remove('text-green-600');
                feedbackTitle.classList.add('text-red-600');
                document.getElementById('correct-answer-info').classList.add('hidden'); // ì •ë‹µ ìˆ¨ê¹€

                // ì˜¤ë‹µ íŒíŠ¸ ì œê³µ
                hintText.textContent = `ğŸ’¡ íŒíŠ¸ (${item.attempts + 1}ë²ˆì§¸ ì‹œë„): ${principles[correctKey].hint}`;
                hintText.classList.remove('hidden');
                document.getElementById('explanation-text').textContent = "ì˜¤ë‹µì…ë‹ˆë‹¤. íŒíŠ¸ë¥¼ ì°¸ê³ í•˜ì—¬ ë‹¤ë¥¸ ì›ì¹™ì„ ë‹¤ì‹œ ì„ íƒí•´ë³´ì„¸ìš”.";
            }

            document.getElementById('correct-principle-text').textContent = principles[correctKey].text;
            document.getElementById('score-display').textContent = score;
            feedbackArea.classList.remove('hidden');
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì •ë‹µì„ ë§ì¶˜ ê²½ìš°ì—ë§Œ ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”)
            updateNavigationButtons(item.isCorrectlyAnswered);

            // ë²„íŠ¼ í•˜ì´ë¼ì´íŠ¸
            const buttons = document.querySelectorAll('#answer-buttons button');
            buttons.forEach(btn => {
                const buttonKey = btn.getAttribute('data-principle');
                const isCurrentButton = buttonKey === userAnswer;
                
                btn.classList.remove('ring-4', 'ring-offset-2', 'ring-red-400', 'ring-green-400', 'ring-sky-400');
                btn.classList.remove('disabled', 'opacity-50');
                btn.removeAttribute('disabled');
                
                // ì •ë‹µì„ ë§ì¶˜ í›„ì—ëŠ” ëª¨ë“  ì„ íƒ ë²„íŠ¼ ë¹„í™œì„±í™” (navigation buttonì€ í™œì„±í™”ë¨)
                if (item.isCorrectlyAnswered) {
                    btn.setAttribute('disabled', 'true');
                    btn.classList.add('disabled', 'opacity-50');
                    if (buttonKey === correctKey) {
                        // ì •ë‹µ ë²„íŠ¼ì„ ë…¹ìƒ‰ìœ¼ë¡œ í‘œì‹œí•˜ê³  í™œì„±í™”ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•¨
                        btn.classList.add('ring-4', 'ring-offset-2', 'ring-green-400', 'opacity-100');
                        btn.classList.remove('opacity-50', 'disabled');
                    }
                } else {
                    // ì •ë‹µì„ ëª» ë§ì·„ë‹¤ë©´, ì˜¤ë‹µ ì²˜ë¦¬ëœ ë²„íŠ¼ë§Œ ë¶‰ì€ìƒ‰ ë§ í‘œì‹œ
                    if (isCurrentButton && !isCorrect) {
                        btn.classList.add('ring-4', 'ring-offset-2', 'ring-red-400');
                    }
                    // ì •ë‹µì„ ëª» ë§ì·„ë‹¤ë©´, ë²„íŠ¼ì„ ê³„ì† ëˆ„ë¥¼ ìˆ˜ ìˆë„ë¡ ì „ì²´ ë¹„í™œì„±í™”ëŠ” ë§‰ìŒ
                }
            });

            // ì •ë‹µì„ ë§ì¶”ì§€ ëª»í–ˆë‹¤ë©´, ë²„íŠ¼ì„ ê³„ì† ëˆ„ë¥¼ ìˆ˜ ìˆë„ë¡ pointer-events-none ì œê±° ìœ ì§€
            if (item.isCorrectlyAnswered) {
                document.getElementById('answer-buttons').classList.add('pointer-events-none');
            } else {
                 document.getElementById('answer-buttons').classList.remove('pointer-events-none');
            }
        }

        /**
         * ì±Œë¦°ì§€ ì™„ë£Œ í™”ë©´ì„ í‘œì‹œí•©ë‹ˆë‹¤. (STEP 4)
         */
        function showCompletionScreen() {
            showScreen('completion-screen');
            document.getElementById('final-score-display').textContent = score;
            document.getElementById('final-user-info-display').textContent = `${studentInfo.id} ${studentInfo.name}`;
        }
        
        // ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘: ì¸íŠ¸ë¡œ í™”ë©´ í˜¸ì¶œ
        window.onload = function() {
            showIntroScreen();
        };

    </script>
</body>
</html>
